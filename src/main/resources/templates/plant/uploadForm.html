<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>설비 일괄 등록 · CMMS</title>
    <!-- common CSS is loaded via layout/defaultLayout -->
    <!-- local fallback for design-only preview without server -->
    <link rel="stylesheet" href="../../static/assets/css/base.css" />
  </head>
  <body>
    <div class="page">
      <header class="appbar">
        <div class="appbar-inner">
          <div class="brand">설비 관리</div>
          <div class="spacer"></div>
          <div class="meta">
            <span class="badge">memberId</span>
            <span>시연용</span>
          </div>
        </div>
      </header>
      <nav class="breadcrumbs">
        <div class="container">
          <a th:href="@{#}" href="#">자산정보</a>
          <span class="sep">/</span>
          <a th:href="@{/plant/list}">설비</a>
          <span class="sep">/</span>
          <span>일괄 등록</span>
        </div>
      </nav>
      <!-- Main Content -->
      <section data-slot-root th:fragment="content" data-page="plant-upload" data-module="plant-upload">
        <main>
        <div class="container">
          <section class="card">
            <div class="card-header">
              <div class="card-title">설비 CSV 업로드</div>
              <div class="toolbar">
                <a class="btn" th:href="@{/plant/list}">목록</a>
              </div>
            </div>
            <div class="card-body">
              <div class="section">
                <div class="section-title">사용 방법</div>
                <div class="section-desc">
                  CSV 헤더는 <code>plant_id</code>, <code>name</code>, <code>asset_id</code>, <code>site_id</code>, <code>dept_id</code>, <code>func_id</code>, <code>install_date</code>(yyyy-MM-dd) 등 필드를 포함할 수 있습니다. <code>name</code>은 필수이며, <code>plant_id</code>를 비우면 자동으로 채번됩니다.
                </div>
                <div class="section-desc">
                  샘플 파일을 내려받아 형식을 확인하세요:
                  <a class="btn sm" href="../../static/assets/samples/plant-upload-sample.csv" download>샘플 CSV 다운로드</a>
                </div>
              </div>
              <form id="uploadForm" method="post" th:action="@{/api/plants/upload}" enctype="multipart/form-data" data-form-manager data-redirect="@{/plant/list}">
                <input type="hidden" name="_csrf" value="" data-csrf-field="true" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <div class="section">
                  <div class="section-title">CSV 파일 선택</div>
                  <div class="grid cols-12">
                    <div class="col-span-6">
                      <input id="csvFile" class="input" type="file" name="file" accept=".csv,text/csv" required />
                    </div>
                    <div class="col-span-6 actions actions-left-align">
                      <button type="submit" class="btn primary">업로드</button>
                    </div>
                  </div>
                </div>
              </form>
              <div class="section">
                <div class="section-title">업로드 결과</div>
                <div id="uploadSummary" class="notice" hidden></div>
              </div>
              <div class="section" id="errorSection" hidden>
                <div class="section-title">오류 내역</div>
                <div class="section-desc">오류가 발생한 행만 아래에 표시됩니다.</div>
                <table class="table">
                  <thead>
                    <tr>
                      <th class="col-120">행 번호</th>
                      <th>오류 메시지</th>
                    </tr>
                  </thead>
                  <tbody data-error-rows></tbody>
                </table>
              </div>
            </div>
          </section>
        </div>
        </main>
      </section>
      <footer>
        <div class="container">© 설비 관리</div>
      </footer>
    </div>
    
    <!-- 인라인 스크립트는 plant.js로 이관됨 -->
  </body>
</html>
